# SSD1306 ディスプレイドライバ
Copyright 2017 Moddable Tech, Inc.<BR>
改訂： 2024年9月10日

[SSD1306](https://cdn-shop.adafruit.com/datasheets/SSD1306.pdf) OLEDディスプレイコントローラは、モノクローム（1ビット）ディスプレイを動作します。ディスプレイは128ピクセルの幅があり、高さは32、64、および128ピクセルで利用可能です。SSD1306コントローラは、SPIまたはI2Cを使用して接続できます。

### プロジェクトにSSD1306を追加する
プロジェクトにSSD1306ドライバを追加するには、そのマニフェストをインクルードします：

```jsonc
"include": [
	/* other includes here */
	"$(MODULES)/drivers/ssd1306/manifest.json"
],
```

CommodettoまたはPiuを使用する場合、マニフェストの`config`オブジェクトの`screen`プロパティを`ssd1306`に設定して、SSD1306をデフォルトのディスプレイドライバにします。タッチ入力がないため、マニフェストでタッチドライバ名を空の文字列に設定して無効にします。

```json
"config": {
	"screen": "ssd1306",
	"touch": ""
},
```

### ピクセルフォーマット
SSD1306ドライバは入力として8ビットグレー（`gray256`）ピクセルを必要とします。`mcconfig`を使用してビルドする場合、コマンドラインでピクセルフォーマットを`gray256`に設定します：

	mcconfig -m -p esp -f gray256

### 定義
`defines`オブジェクトで、ピクセルの`width`と`height`を宣言します。デフォルトの接続はSPIですが、アプリケーションマニフェストで接続タイプを明示的に設定することをお勧めします：

```json
"defines": {
	"ssd1306": {
		"width": 128,
		"height": 32,
		"spi": true,
		"i2c": false
	}
}
```

### ディザー
SSD1306ドライバはオプションでディザリングを実装しています。ディザリングにより、白黒OLEDディスプレイ上で灰色のピクセルを近似することができます。ディザリングを有効にすると、約520バイトのRAMを追加で使用し、描画速度が遅くなります。ディザリングが特定のアプリケーションに最適かどうかは、描画内容と必要なフレームレートによります。ディザリングはデフォルトでは無効になっています。ディザリングを有効にするには、マニフェストの`defines`セクションで`dither`プロパティを`true`に設定します。

```jsonc
"defines": {
	"ssd1306": {
		/* other properties here */
		"dither": true
	}
}
```

### SPIを使う
SPIインターフェースを使用する場合、`defines`オブジェクトには`spi_port`、および`DC`と`CS`のピン番号を含める必要があります。`RST`ピンが提供されている場合、コンストラクタが呼び出されたときにデバイスがリセットされます。`cs_port`、`dc_port`、または`rst_port`プロパティが提供されていない場合、それらはNULLにデフォルト設定されます。

```jsonc
"defines": {
	"ssd1306": {
		/* other properties here */
		"cs_pin": 4,
		"dc_pin": 2,
		"rst_pin": 0,
		"spi_port": "#HSPI",
		"spi": true,
		"i2c": false
	}
}
```

`hz`プロパティが存在する場合、SPIバスの速度を指定します。

### I2Cを使用する
I2Cインターフェースを使用する場合、`defines`オブジェクトにはデバイスのI2Cアドレスを含めることができます。提供されていない場合、デフォルトで`0x3C`に設定されるか、辞書の`address`プロパティとしてコンストラクタに渡すことができます。`scl_pin`と`sda_pin`プロパティは、I2Cに使用するピンを定義します。存在しない場合、辞書の`scl`および`sda`プロパティとしてコンストラクタに提供することができます。コンストラクタに渡されない場合、デフォルトのI2Cインターフェースが使用されます。

```jsonc
"defines": {
	"ssd1306": {
		/* other properties here */
		"scl_pin": 4,
		"sda_pin": 5,
		"address": 0x3c,
		"spi": false,
		"i2c": true
	}
}
```

`hz` プロパティは、存在する場合、I2C バスの速度を指定します。

**注意**: I2C インターフェースは通常、より低速で動作するため、利用可能な場合は SPI が推奨されます。

### 描画
SSD1306 ドライバは常にフルディスプレイエリアを更新します。部分的な更新はサポートされていません。Piu を使用するスクリプトでは、Piu が自動的にこれを処理するため、これを考慮する必要はありません。Poco を使用する場合、画面全体を更新する簡単な方法は、パラメータなしで `poco.begin()` を呼び出すことです。

8 ピクセル高のフル幅バンドに量子化された部分更新を実装することが可能かもしれません。

